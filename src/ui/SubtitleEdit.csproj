<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFrameworks>net48;net8.0-windows</TargetFrameworks>
    <ApplicationIcon>SE.ico</ApplicationIcon>
    <BootstrapperEnabled>true</BootstrapperEnabled>
    <ManifestCertificateThumbprint>DCCE7922B5E425ADB221E06DC2FB405664CF8F63</ManifestCertificateThumbprint>
    <MapFileExtensions>true</MapFileExtensions>
    <OutputType>WinExe</OutputType>
    <PublishWizardCompleted>true</PublishWizardCompleted>
    <RestorePackages>true</RestorePackages>
    <RootNamespace>Nikse.SubtitleEdit</RootNamespace>
    <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">.\</SolutionDir>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    <UseWindowsForms>true</UseWindowsForms>
    <ImportWindowsDesktopTargets>true</ImportWindowsDesktopTargets>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
  </PropertyGroup>
  <PropertyGroup>
    <ApplicationManifest>app.manifest</ApplicationManifest>
  </PropertyGroup>
  <ItemGroup>
    <Compile Update="Controls\CuesPreviewView.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\NikseComboBox.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\NikseLabel.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\NikseListBox.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\NikseTextBox.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\NikseTimeUpDown.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\NikseUpDown.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\SETextBox.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\AdvancedTextBox.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\SimpleTextBox.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\ToolStripNikseComboBox.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\ToolStripNikseSeparator.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\VideoPlayerContainer.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Update="Controls\AudioVisualizer.cs">
      <SubType>UserControl</SubType>
    </Compile>
    <Compile Update="Controls\SubtitleListView.cs">
      <SubType>Component</SubType>
    </Compile>
    <EmbeddedResource Include="Resources\HunspellDictionaries.xml.gz" />
    <EmbeddedResource Include="Resources\HunspellBackupDictionaries.xml.gz" />
    <EmbeddedResource Include="Resources\TesseractDictionaries.xml.gz" />
    <EmbeddedResource Include="Resources\eleven-labs-voices.zip" />
    <EmbeddedResource Include="Resources\AzureVoices.zip" />
    <EmbeddedResource Include="Resources\AllTalkVoices.zip" />
    <EmbeddedResource Include="Resources\PiperVoices.zip" />
    <None Update="Resources\SMPTE-428-7-2007-DCST.xsd">
      <SubType>Designer</SubType>
    </None>
    <EmbeddedResource Include="Resources\SMPTE-428-7-2007-DCST.xsd.gz" />
    <None Update="Resources\SMPTE-428-7-2010-DCST.xsd">
      <SubType>Designer</SubType>
    </None>
    <EmbeddedResource Include="Resources\SMPTE-428-7-2010-DCST.xsd.gz" />
    <None Update="Resources\SMPTE-428-7-2014-DCST.xsd">
      <SubType>Designer</SubType>
    </None>
    <EmbeddedResource Include="Resources\SMPTE-428-7-2014-DCST.xsd.gz" />
  </ItemGroup>
  <ItemGroup>
    <Content Include="DLLs\Voikkox64.dll" />
    <Content Include="DLLs\Voikkox86.dll" />
    <Content Include="Icons\BeautifyTimeCodes.png" />
    <None Update="Hunspellx64.dll">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Update="Hunspellx86.dll">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <Content Include="Languages\ar-EG.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\bg-BG.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\br-FR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\ca-ES.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\cs-CZ.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\da-DK.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\de-DE.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\el-GR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\es-AR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\es-ES.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\es-MX.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\eu-ES.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\fa-IR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\fi-FI.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\fr-BE.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\fr-FR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\he-IL.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\hr-HR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\hu-HU.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\id-ID.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\it-IT.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\ja-JP.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\ko-KR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\mk-MK.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\nb-NO.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\nl-NL.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\pl-PL.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\pt-BR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\pt-PT.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\ro-RO.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\ru-RU.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\sl-SI.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\sr-Cyrl-RS.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\sr-Latn-RS.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\sv-SE.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\th-TH.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\tr-TR.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\uk-UA.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\vi-VN.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\zh-Hans.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Languages\zh-TW.xml">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <Content Include="Icons\SE.ico" />
    <Content Include="Icons\Find.png" />
    <Content Include="Icons\FixCommonErrors.png" />
    <Content Include="Icons\Help.png" />
    <Content Include="Icons\New.png" />
    <Content Include="Icons\Open.png" />
    <Content Include="Icons\RemoveTextForHI.png" />
    <Content Include="Icons\Replace.png" />
    <Content Include="Icons\Save.png" />
    <Content Include="Icons\SaveAs.png" />
    <Content Include="Icons\Settings.png" />
    <Content Include="Icons\SpellCheck.png" />
    <Content Include="Icons\VideoToggle.png" />
    <Content Include="Icons\VisualSync.png" />
    <Content Include="Icons\WaveformToggle.png" />
    <Content Include="Resources\TesseractDictionaries.xml">
      <SubType>Designer</SubType>
    </Content>
    <Content Include="Resources\HunspellBackupDictionaries.xml">
      <SubType>Designer</SubType>
    </Content>
    <Content Include="Resources\HunspellDictionaries.xml">
      <SubType>Designer</SubType>
    </Content>
  </ItemGroup>
  <ItemGroup>
    <BootstrapperPackage Include="Microsoft.Net.Client.3.5">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1 Client Profile</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.2.0">
      <Visible>False</Visible>
      <ProductName>.NET Framework 2.0 %28x86%29</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.0">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.0 %28x86%29</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.5">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.5.SP1">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Visual.C++.10.0.x86">
      <Visible>False</Visible>
      <ProductName>Visual C++ 2010 Runtime Libraries %28x86%29</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Windows.Installer.3.1">
      <Visible>False</Visible>
      <ProductName>Windows Installer 3.1</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\libse\LibSE.csproj" />
  </ItemGroup>
  <ItemGroup>
    <HunspellAssemblies Include="Hunspellx64.dll">
      <Visible>false</Visible>
    </HunspellAssemblies>
    <HunspellAssemblies Include="Hunspellx86.dll">
      <Visible>false</Visible>
    </HunspellAssemblies>
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="Microsoft.Bcl" Version="1.1.10" />
    <PackageReference Include="Microsoft.Bcl.Build" Version="1.0.21" />
    <PackageReference Include="Microsoft.Net.Http" Version="2.2.29" />
    <PackageReference Include="Microsoft.Win32.Registry" Version="5.0.0" />
    <PackageReference Include="NAudio.Core" Version="2.2.1" />
    <PackageReference Include="NAudio.WinMM" Version="2.2.1" />
    <PackageReference Include="ncalc" Version="1.3.8" />
    <PackageReference Include="Newtonsoft.Json" Version="13.0.3" />
    <PackageReference Include="NHunspell" Version="1.2.5554.16953" />
    <PackageReference Include="System.Security.AccessControl" Version="6.0.1" />
    <PackageReference Include="System.Security.Principal.Windows" Version="5.0.0" />
    <PackageReference Include="System.Speech" Version="8.0.0" />
    <PackageReference Include="Vosk" Version="0.3.38" />
  </ItemGroup>

  <ItemGroup>
    <Reference Include="Interop.QuartzTypeLib, Version=1.0.0.0, Culture=neutral, processorArchitecture=MSIL">
      <EmbedInteropTypes>True</EmbedInteropTypes>
      <HintPath>DLLs\Interop.QuartzTypeLib.dll</HintPath>
      <SpecificVersion>False</SpecificVersion>
    </Reference>
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFramework)' == 'net8.0-windows'">
    <PackageReference Include="System.Speech" Version="8.0.0" />
  </ItemGroup>
  
  <ItemGroup Condition="'$(TargetFramework)' == 'net48'">
    <Reference Include="System.Net.Http.WebRequest" />
    <Reference Include="System.Speech" />
    <Reference Include="System.Web.Services" />
  </ItemGroup>
  
  <ItemGroup>
    <Compile Remove="Logic\VideoPlayers\DirectShowLib2005.cs" />
    <EmbeddedResource Remove="Forms\GetDictionaries.resx" />
  </ItemGroup>
  <Target Name="BeforeCompile">
    <XmlPeek XmlInputPath="$(ProjectDir)packages.config" Query="//package[@id='NHunspell']/@version">
      <Output TaskParameter="Result" PropertyName="HunspellVersion" />
    </XmlPeek>
    <PropertyGroup>
      <HunspellDir>..\..\packages\NHunspell.$(HunspellVersion)\content\</HunspellDir>
    </PropertyGroup>
    <Copy SourceFiles="@(HunspellAssemblies -&gt; '$(HunspellDir)%(Identity)')" DestinationFolder="$(OutputPath)" SkipUnchangedFiles="True" />
    <Exec Condition="'$(OS)' == 'Windows_NT'" Command="%22$(SolutionDir)\build_helpers.bat%22 rev %22$(ConfigurationName)%22" />
    <Exec Condition="'$(OS)' == 'Unix'" Command="bash $(ProjectDir)../../build_helpers.sh rev $(ConfigurationName)" />
  </Target>
  <Target Name="BeforeClean">
    <Delete Files="@(HunspellAssemblies -&gt; '$(OutputPath)%(Identity)')" />
  </Target>
</Project>